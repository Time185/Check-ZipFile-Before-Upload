<!DOCTYPE html>
<html>
<head lang="en">
<meta charset="UTF-8">
<title>Insert title here</title>
	<style >
		code{
			display: block;
			padding:10px;
			background: #eee;
		}
	</style>
</head>
<body>
	<input type="button" id="button" value="提交"/>
</body>

<script src="zip.js"></script>
<script src="zip-fs.js"></script>
<script src="zip-ext.js"></script>
<script type="text/javascript" src="config.js"></script>
<script>
	document.getElementById("button").onclick = function () {
	var URL = "testData.zip";
    var zipFs = new zip.fs.FS();
    function onerror(message) {
    	console.error(message);
    }
    
    function zipImportedZip(callback) {
        var directory = zipFs.root.addDirectory("import");
        console.log("bbb")
        directory.importHttpContent(URL, false, function() {
            zipFs.exportBlob(callback);
            console.log("ccc");
        }, onerror);
    }
    
    function unzipBlob(blob, callback) {
        zipFs.importBlob(blob, function() {
            var directory = zipFs.root.getChildByName("import");
            var firstEntry = directory.children[0];
            firstEntry.getText(callback);
            var secendEntry = directory.children[1];
            console.log(secendEntry);
            secendEntry.getText(callback);
        }, onerror);
    }
	
    function logText(text) {
        console.log(text);
        console.log("--------------");
    }

    zipImportedZip(function(zippedBlob) {
        unzipBlob(zippedBlob, function(unzippedText) {
            logText(unzippedText);
        });
    });
}
</script>
</html>